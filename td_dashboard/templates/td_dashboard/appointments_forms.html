{% load staticfiles %}

{% block extra-css %}
	<link rel="stylesheet" type="text/css" href="{% static "td_dashboard/css/table.css" %}" >
{% endblock extra-css %}

{% block appointments %}
  	<hr style="margin-top:4px; margin-bottom:4px;">
	<p>
	<h5>Appointments</h5>                        
	<a href="#">add continuation appointment</a>
	</p>
	{% if scheduled_entry_meta_data %} <I>(Hint: to see all appointments, click 'show appointments' in the Action column below)</I>{% endif%}
	    <table width="100%" class="table table-bordered table-striped table-condensed">
	    <thead>
	    <th>Code</th>
	    <th>Description</th>
	    <th>Type</th>
	    <th>Appt. Date</th>
	    <th>Status</th>
	    <th>Visit Report</th>
	    <th>Visit Reason</th>      
	    <th>Action</th>                                    
	    </thead>
	    <tbody>
	    {% if not appointments%}
	        <tr class="{% cycle 'row1' 'row2' %}"><td colspan="8"><i>No appointments scheduled</i></td></tr>
	    {% else %}
	        {% for appointment in appointments %}
	            <tr class="{% cycle 'row1' 'row2' %}">
	            <td>{{appointment.visit_code}}</td>
		        <td>{{appointment.appt_title}}</td>
				<td>{{appointment.appt_type | capfirst}}</td>
				<td>{{appointment.appt_datetime|date:"Y-m-d D"| capfirst}}</td>
				<td><a href="{% url 'admin:td_appointment_appointment_change' appointment.str_pk %}?next=subject_dashboard_url&subject_identifier={{ appointment.subject_identifier }}">{{ appointment.appt_status | capfirst }}</a></td>
		        <td>
		        	{% if appointment.maternal_visit %}
		        		<a href="{% url 'admin:td_maternal_maternalvisit_change' appointment.maternal_visit.pk %}?next=subject_dashboard_url&subject_identifier={{ appointment.subject_identifier }}">{{ appointment.maternal_visit.report_datetime |date:"Y-m-d D"| capfirst }}</a>
		        	{% else %}
		        		<a href="{% url 'admin:td_maternal_maternalvisit_add' %}?next=subject_dashboard_url&subject_identifier={{ appointment.subject_identifier }}&visit_code={{ appointment.visit_code }}">Add Visit</a>
		        	{% endif %}
		        </td>
		        <td>{{appointment.maternal_visit.reason}}</td>
			    <td>
			    	{% if show %}
			    		<a href="{% url 'subject_dashboard_url' subject_identifier %}">show appointments</a>
			    	{% else %}
			    		{% if appointment.maternal_visit %} 
			    			<a href="{% url 'subject_dashboard_url' appointment.str_pk subject_identifier %}?show=forms">show forms</a>
			    		{% endif %}
			    	{% endif %}
			    </td>
	            </tr>
	        {% endfor %}
	    {% endif %}
	    </tbody>
	    </table>	    
{% endblock appointments %}
